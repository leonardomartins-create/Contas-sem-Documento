<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>KYC - Fila de AnÃ¡lise</title>
    <link href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/tabulator.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background-color: #f0f2f5; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        #search-input { padding: 10px; width: 300px; border: 1px solid #ccc; border-radius: 5px; }
        .tabulator { border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .high-saldo { color: #d32f2f; font-weight: bold; }
    </style>
</head>
<body>

<div class="header">
    <h2>ðŸš€ KYC - Fila de AnÃ¡lise PrioritÃ¡ria</h2>
    <input type="text" id="search-input" placeholder="ðŸ” Filtrar ID, Natureza ou Segmento...">
</div>

<div id="table-container"></div>

<script>
    // 1. FunÃ§Ã£o para carregar o CSV que vocÃª vai subir no Git
    // O nome do arquivo deve ser exatamente 'dados.csv'
    Papa.parse("dados.csv", {
        download: true,
        header: true,
        dynamicTyping: true,
        complete: function(results) {
            renderTable(results.data);
        }
    });

    function renderTable(data) {
        var table = new Tabulator("#table-container", {
            data: data,
            layout: "fitColumns",
            pagination: "local",
            paginationSize: 15,
            placeholder: "Nenhum dado encontrado. Certifique-se de que o arquivo 'dados.csv' foi enviado.",
            columns: [
                {title: "ID Cliente", field: "customer_id", sorter: "number", width: 120},
                {title: "Natureza", field: "natureza_juridica", width: 150},
                {title: "Segmento", field: "segmento_commercial", width: 150},
                {title: "Saldo", field: "saldo", formatter: "money", formatterParams:{
                    decimal: ",", thousands: ".", symbol: "R$ "
                }, hozAlign: "right", bottomCalc: "sum", width: 150},
                {title: "AÃ§Ãµes", field: "link_cliente", formatter: "link", formatterParams: {
                    label: "Abrir Cliente ðŸ”—",
                    target: "_blank",
                }, hozAlign: "center"},
                {title: "Doc AnÃ¡lise", field: "link_analise_documento", formatter: "link", formatterParams: {
                    label: "Ver Docs ðŸ“„",
                    target: "_blank",
                }, hozAlign: "center"},
            ],
        });

        // Filtro de Busca Global
        document.getElementById("search-input").addEventListener("keyup", function(e){
            table.setFilter([
                [{field: "customer_id", type: "like", value: e.target.value},
                 {field: "natureza_juridica", type: "like", value: e.target.value},
                 {field: "segmento_commercial", type: "like", value: e.target.value}]
            ]);
        });
    }
</script>
</body>
</html>
