<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYC - Contas sem Documento | Asaas</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <script src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/tabulator.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/luxon/3.4.4/luxon.min.js"></script>

    <style>
        :root {
            --azul-asaas: #0030b9;
            --azul-escuro: #001074;
            --azul-claro: #0198ff;
            --cinza-bg: #f1f5fb;
            --verde-asaas: #8ebf30;
            --rosa-asaas: #ff365e;
        }

        body { 
            font-family: 'Montserrat', sans-serif; 
            background-color: var(--cinza-bg); 
            margin: 0; 
            padding: 0;
            color: var(--azul-escuro);
        }

        /* Topbar com Logo */
        .navbar {
            background-color: white;
            padding: 15px 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .navbar img {
            height: 30px; /* Ajuste conforme o link do seu logo */
        }

        .container { padding: 30px 40px; }

        .header-title {
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-title h2 {
            font-weight: 700;
            margin: 0;
            color: var(--azul-asaas);
            font-size: 24px;
        }

        /* Grid de Filtros Estilo Moderno */
        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .filter-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
            border: 1px solid #e0e6ed;
        }

        .filter-card label {
            display: block;
            font-weight: 700;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            color: var(--azul-claro);
        }

        .btn-group { display: flex; flex-wrap: wrap; gap: 8px; }

        button {
            border: 1px solid #e0e6ed;
            background: white;
            color: var(--azul-escuro);
            padding: 8px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
        }

        button:hover {
            border-color: var(--azul-asaas);
            color: var(--azul-asaas);
        }

        button.active {
            background-color: var(--azul-asaas);
            color: white;
            border-color: var(--azul-asaas);
        }

        input[type="date"], input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0e6ed;
            border-radius: 6px;
            font-family: 'Montserrat', sans-serif;
            outline: none;
            box-sizing: border-box;
        }

        /* Estiliza√ß√£o da Tabela Tabulator */
        .tabulator {
            border: none !important;
            background-color: transparent !important;
        }

        .tabulator-header {
            background-color: transparent !important;
            color: var(--azul-claro) !important;
            font-weight: 700 !important;
            text-transform: uppercase;
            font-size: 11px;
        }

        .tabulator-row {
            background-color: white !important;
            margin-bottom: 5px !important;
            border-radius: 8px !important;
            border: 1px solid #e0e6ed !important;
        }

        .link-btn {
            text-decoration: none;
            color: var(--azul-asaas);
            font-weight: 700;
            font-size: 11px;
        }

        .link-btn:hover { color: var(--azul-claro); }

    </style>
</head>
<body>

<div class="navbar">
    <img src="https://www.asaas.com/assets/logo-asaas.svg" alt="Asaas Logo" onerror="this.src='https://via.placeholder.com/120x30?text=ASAAS'">
    <div style="font-size: 12px; font-weight: 600; color: var(--azul-claro);">ANALISE & PREVEN√á√ÉO</div>
</div>

<div class="container">
    <div class="header-title">
        <h2>üöÄ KYC - Contas sem Documento</h2>
    </div>

    <div class="filter-grid">
        <div class="filter-card">
            <label><i class="fa-solid fa-wallet"></i> Faixa de Saldo</label>
            <div class="btn-group">
                <button class="btn-saldo active" onclick="filterSaldo(0, this)">Todos</button>
                <button class="btn-saldo" onclick="filterSaldo(5000, this)">> 5k</button>
                <button class="btn-saldo" onclick="filterSaldo(20000, this)">> 20k</button>
                <button class="btn-saldo" onclick="filterSaldo(50000, this)">> 50k</button>
            </div>
        </div>

        <div class="filter-card">
            <label><i class="fa-solid fa-calendar-days"></i> Per√≠odo de Abertura</label>
            <div class="btn-group" style="margin-bottom: 10px;">
                <button class="btn-data" onclick="filterData(15, this)">15d</button>
                <button class="btn-data" onclick="filterData(20, this)">20d</button>
                <button class="btn-data" onclick="filterData(30, this)">30d</button>
            </div>
            <input type="date" id="date-picker" onchange="filterDataEspecifica(this.value)">
        </div>

        <div class="filter-card">
            <label><i class="fa-solid fa-magnifying-glass"></i> Busca R√°pida</label>
            <input type="text" id="search-input" placeholder="Digite o ID do cliente...">
            <div style="margin-top: 10px;">
                <button onclick="clearFilters()" style="width: 100%; border-style: dashed;"><i class="fa-solid fa-eraser"></i> Limpar Tudo</button>
            </div>
        </div>
    </div>

    <div id="table-container"></div>
</div>

<script>
    var table;

    // Carregar CSV
    Papa.parse("dados.csv", {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
            renderTable(results.data);
        }
    });

    function renderTable(data) {
        table = new Tabulator("#table-container", {
            data: data,
            layout: "fitColumns",
            pagination: "local",
            paginationSize: 15,
            responsiveLayout: "collapse",
            columns: [
                {title: "ID Cliente", field: "customer_id", width: 140, fontWeight: "bold"},
                {title: "Abertura", field: "data_criacao", width: 130, formatter: function(cell){
                    return luxon.DateTime.fromISO(cell.getValue()).toFormat('dd/MM/yyyy');
                }},
                {title: "Natureza", field: "natureza_juridica", width: 150},
                {title: "Saldo", field: "saldo", hozAlign: "right", formatter: "money", formatterParams: {
                    decimal: ",", thousands: ".", symbol: "R$ "
                }, fontWeight: "700"},
                {title: "Perfil Asaas", field: "link_cliente", hozAlign: "center", formatter: function(cell){
                    return `<a href="${cell.getValue()}" target="_blank" class="link-btn"><i class="fa-solid fa-user-gear"></i> ABRIR</a>`;
                }},
                {title: "An√°lise Docs", field: "link_analise_documento", hozAlign: "center", formatter: function(cell){
                    return `<a href="${cell.getValue()}" target="_blank" class="link-btn" style="color: var(--verde-asaas)"><i class="fa-solid fa-file-shield"></i> DOCUMENTOS</a>`;
                }},
            ],
        });

        document.getElementById("search-input").addEventListener("keyup", function(e){
            table.setFilter("customer_id", "like", e.target.value);
        });
    }

    // Filtros com Feedback Visual nos Bot√µes
    function filterSaldo(min, btn) {
        resetBtnStyles(".btn-saldo");
        btn.classList.add("active");
        table.clearFilter();
        if(min > 0) table.addFilter("saldo", ">", min);
    }

    function filterData(dias, btn) {
        resetBtnStyles(".btn-data");
        btn.classList.add("active");
        table.clearFilter();
        var dataLimite = luxon.DateTime.now().minus({days: dias}).toISODate();
        table.addFilter("data_criacao", ">=", dataLimite);
    }

    function filterDataEspecifica(valor) {
        resetBtnStyles(".btn-data");
        table.clearFilter();
        table.addFilter("data_criacao", "=", valor);
    }

    function resetBtnStyles(selector) {
        document.querySelectorAll(selector).forEach(b => b.classList.remove("active"));
    }

    function clearFilters() {
        table.clearFilter();
        resetBtnStyles("button");
        document.querySelector(".btn-saldo").classList.add("active");
        document.getElementById("date-picker").value = "";
        document.getElementById("search-input").value = "";
    }
</script>
</body>
</html>
